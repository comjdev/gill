<!-- prettier-ignore -->
<%
// Get the page data from the page object
var pageData = page;
var image = '/img/' + page.category + '-photos-header.jpg';

// Filter testimonials by category and select a random one
var allTestimonials = site.data.testimonials.testimonials;
var categoryTestimonials = allTestimonials.filter(function(testimonial) {
    return testimonial.type === page.category;
});

var randomTestimonialIndex = 0;
if (categoryTestimonials.length > 0) {
    var randomIndex = Math.floor(Math.random() * categoryTestimonials.length);
    var randomTestimonial = categoryTestimonials[randomIndex];
    // Find the original index of this testimonial in the full array
    randomTestimonialIndex = allTestimonials.indexOf(randomTestimonial);
}
%>

<main class="pb-16 lg:pb-24 bg-gill-green-100 antialiased">
	<header class="relative h-[60vh]">
		<div class="absolute inset-0">
			<img
				src="<%= image || '/img/newborn-photos-header.jpg' %>"
				alt="<%= typeof page.title !== 'undefined' && page.title ? page.title : 'Family Photography in ' + page.suburb %> | Gill Juergens Photography"
				class="w-full h-full object-cover"
				loading="lazy"
			/>
			<div class="absolute inset-0 bg-black/60"></div>
		</div>
		<div
			class="absolute top-20 left-1/2 px-4 mx-auto w-full max-w-screen-xl -translate-x-1/2 xl:top-1/2 xl:-translate-y-1/2 xl:px-0"
		>
			<div class="block mb-4 font-light text-gray-300">
				<%= page.category.charAt(0).toUpperCase() + page.category.slice(1) %>
				<span class="font-light text-white hover:underline">Photography</span>
			</div>
			<h1
				class="mb-4 max-w-4xl text-2xl font-light leading-none text-white sm:text-3xl lg:text-4xl"
			>
				<%= page.title %>
			</h1>
			<p class="text-lg font-light text-gray-300"><%= page.subtitle %></p>
		</div>
	</header>

	<div
		class="flex relative z-20 justify-between p-6 -m-36 mx-4 max-w-screen-xl bg-white rounded xl:-m-32 xl:p-9 xl:mx-auto"
	>
		<article
			class="xl:w-[828px] w-full max-w-none format format-sm sm:format-base"
		>
			<header class="lead"><%= page.description %></header>
			<main>
				<%- page.content %>
				<!-- prettier-ignore -->
				<div class="not-format">
					<%- include('_partials/suburbs/contact', {suburb: page.suburb, category: page.category}) %>
				</div>
			</main>
		</article>
		<%- include('_partials/sidebar-services', {suburb: page.suburb}) %>
	</div>
</main>

<!-- Projects  -->
<%- include('_partials/projects-slider', { category: page.category, limit: 6,
showCategoryInHeading: true, suburb: page.suburb }) %>

<!-- Testimonials -->
<%- include('_partials/testimonial', {index: randomTestimonialIndex}) %>

<!-- Local References -->
<%- partial('_partials/suburbs/local-references', {suburb: page.suburb}) %>

<!-- Random FAQs  -->
<%- partial('_partials/suburbs/random-faqs', {suburb: page.suburb, category:
page.category}) %>
